# 壁編集機能 - 簡単ガイド

## 🎯 できること

平面図プレビューで、マウス操作により簡単に壁を作成できます。

### 機能1: 線を描いて壁作成
- マウスで線を描く → 「壁作成」ボタン → 壁が作成される
- **制約**: 水平・垂直方向のみ、既存の壁と自動接続、高さは既存と同じ

### 機能2: エリアを描いて部屋作成
- マウスでエリアを囲む → 「部屋作成」ボタン → 矩形の部屋（4つの壁）が作成される
- **制約**: 矩形のみ、既存の壁と自動接続、高さは既存と同じ

## 📝 使い方（3ステップ）

### ステップ1: 壁編集モードをON
1. アプリを起動: `streamlit run app.py`
2. 「1. 案件ビュー」→「平面図」タブを開く
3. 「🖊️ 壁編集モード」トグルをON

### ステップ2: 壁を作成
#### パターンA: 壁を1本作成
1. 「🖱️ 壁を描く」ボタンをクリック
2. 始点の座標を入力 (例: X=1000, Y=1000) → 「➕ 点を追加」
3. 終点の座標を入力 (例: X=3000, Y=1000) → 「➕ 点を追加」
4. 「✅ 壁を作成」ボタンをクリック

#### パターンB: 部屋を作成
1. 「🔲 部屋を描く」ボタンをクリック
2. 左下の座標を入力 (例: X=500, Y=500) → 「➕ 点を追加」
3. 右上の座標を入力 (例: X=3500, Y=4500) → 「➕ 点を追加」
4. 「✅ 部屋を作成」ボタンをクリック

### ステップ3: 確認
- **青色の線**: 新規作成された壁
- **黒色の線**: 既存の壁
- 画面下部に新規壁の情報が表示されます

## 🔧 便利な機能

### 自動スナップ
- **グリッドスナップ**: 50mm単位で自動調整
- **水平・垂直スナップ**: 線が自動的に水平または垂直になる
- **壁接続スナップ**: 既存の壁に自動接続（100mm以内）

### 操作ボタン
- 🖱️ **壁を描く**: 壁作成モード
- 🔲 **部屋を描く**: 部屋作成モード
- 👁️ **表示モード**: 通常表示に戻る
- 🗑️ **クリア**: 描画中の点をクリア
- ↩️ **元に戻す**: 最後の壁を削除

## 💡 使用例

### 例1: 簡単な壁（水平）
```
始点: (1000, 1000)
終点: (3000, 1000)
結果: 長さ2000mmの水平な壁
```

### 例2: 簡単な壁（垂直）
```
始点: (1000, 1000)
終点: (1000, 3000)
結果: 長さ2000mmの垂直な壁
```

### 例3: 小部屋
```
左下: (500, 500)
右上: (3500, 4500)
結果: 3000mm × 4000mmの矩形の部屋
```

## ⚠️ 制約

- **最小壁長**: 100mm
- **最小部屋サイズ**: 500mm × 500mm
- **壁方向**: 水平または垂直のみ
- **接続閾値**: 既存の壁から100mm以内で自動接続

## 🚧 今後の対応予定

- ✅ 壁作成（水平・垂直）
- ✅ 部屋作成（矩形）
- 🔄 **割付・板取への反映**（開発中）
- 📋 壁の削除・編集
- 🎨 壁の属性編集（厚さ、高さ）
- 📐 斜め壁のサポート

## ❓ よくある質問

**Q: 壁が作成できない**
- A: 線の長さが100mm以上あることを確認してください

**Q: 壁が接続されない**
- A: 既存の壁から100mm以内に点を配置してください

**Q: 部屋が作成できない**
- A: 最低2点を入力し、サイズが500mm × 500mm以上であることを確認してください

**Q: 割付・板取に反映されない**
- A: 現在開発中です。将来のバージョンで対応予定です

---

**注意**: この機能はPoC（概念実証）段階です。
